<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>EcoUno - Belajar Pilah Sampah sambil Bermain</title>
    <style>
        :root {
            --hijau: #4CAF50;
            --kuning: #FFC107;
            --merah: #F44336;
            --biru: #2196F3;
            --hitam: #333;
            --putih: #f9f9f9;
            --abu: #e0e0e0;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background-color: #f5f5f5;
            color: var(--hitam);
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            background-image: url('https://images.unsplash.com/photo-1513151233558-d860c5398176?ixlib=rb-1.2.1&auto=format&fit=crop&w=1350&q=80');
            background-size: cover;
            background-position: center;
            background-attachment: fixed;
            background-blend-mode: overlay;
            background-color: rgba(245, 245, 245, 0.9);
        }

        header {
            background-color: rgba(76, 175, 80, 0.9);
            color: white;
            padding: 1rem;
            text-align: center;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            position: relative;
            z-index: 10;
        }

        .header-content {
            max-width: 1200px;
            margin: 0 auto;
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .logo img {
            height: 50px;
        }

        .logo h1 {
            font-size: 1.8rem;
            font-weight: 700;
        }

        nav ul {
            display: flex;
            list-style: none;
            gap: 20px;
        }

        nav a {
            color: white;
            text-decoration: none;
            font-weight: 600;
            padding: 0.5rem 1rem;
            border-radius: 4px;
            transition: all 0.3s;
        }

        nav a:hover {
            background-color: rgba(255, 255, 255, 0.2);
        }

        .hamburger {
            display: none;
            cursor: pointer;
            font-size: 1.5rem;
        }

        main {
            flex: 1;
            padding: 2rem;
            max-width: 1200px;
            margin: 0 auto;
            width: 100%;
        }

        .game-container {
            display: flex;
            flex-direction: column;
            gap: 2rem;
            background-color: rgba(255, 255, 255, 0.95);
            border-radius: 12px;
            padding: 2rem;
            box-shadow: 0 8px 24px rgba(0, 0, 0, 0.1);
        }

        .game-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 1rem;
        }

        .game-info {
            display: flex;
            gap: 1rem;
            align-items: center;
        }

        .player-info {
            background-color: var(--abu);
            padding: 0.5rem 1rem;
            border-radius: 8px;
            font-weight: 600;
        }

        .score {
            background-color: var(--kuning);
            color: var(--hitam);
            padding: 0.5rem 1rem;
            border-radius: 8px;
            font-weight: 700;
        }

        .game-board {
            display: flex;
            flex-direction: column;
            gap: 2rem;
            position: relative;
        }

        .opponents {
            display: flex;
            justify-content: space-around;
            flex-wrap: wrap;
            gap: 1rem;
        }

        .opponent {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 0.5rem;
        }

        .opponent-cards {
            display: flex;
            gap: 2px;
        }

        .opponent-card {
            width: 30px;
            height: 45px;
            background-color: var(--putih);
            border: 1px solid var(--hitam);
            border-radius: 4px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        .opponent-name {
            font-weight: 600;
            background-color: var(--abu);
            padding: 0.25rem 0.5rem;
            border-radius: 4px;
        }

        .play-area {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 1rem;
            position: relative;
            min-height: 200px;
        }

        .discard-pile {
            width: 80px;
            height: 120px;
            background-color: var(--putih);
            border-radius: 8px;
            display: flex;
            justify-content: center;
            align-items: center;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
            position: relative;
            cursor: pointer;
            transition: transform 0.3s;
        }

        .discard-pile:hover {
            transform: translateY(-5px);
        }

        .draw-pile {
            width: 80px;
            height: 120px;
            background-color: var(--abu);
            border-radius: 8px;
            display: flex;
            justify-content: center;
            align-items: center;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
            cursor: pointer;
            position: absolute;
            left: calc(50% - 100px);
            transition: transform 0.3s;
        }

        .draw-pile:hover {
            transform: translateY(-5px);
        }

        .draw-pile::after {
            content: "AMBIL";
            position: absolute;
            bottom: -25px;
            font-size: 0.8rem;
            font-weight: 600;
            color: var(--hitam);
        }

        .current-color {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            border: 3px solid white;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
            position: absolute;
            right: calc(50% - 120px);
            top: 50%;
            transform: translateY(-50%);
        }

        .player-hand {
            display: flex;
            justify-content: center;
            flex-wrap: wrap;
            gap: 10px;
            padding: 1rem;
            min-height: 150px;
        }

        .card {
            width: 80px;
            height: 120px;
            border-radius: 8px;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
            padding: 0.5rem;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
            cursor: pointer;
            transition: transform 0.3s;
            position: relative;
            overflow: hidden;
            user-select: none;
        }

        .card:hover {
            transform: translateY(-20px) scale(1.05);
            z-index: 5;
        }

        .card.selected {
            transform: translateY(-40px) scale(1.1);
            box-shadow: 0 8px 16px rgba(0, 0, 0, 0.3);
            z-index: 10;
        }

        .card-number {
            font-size: 1.5rem;
            font-weight: 700;
            align-self: flex-start;
        }

        .card-icon {
            font-size: 2rem;
            align-self: center;
        }

        .card-label {
            font-size: 0.7rem;
            align-self: flex-end;
            text-align: right;
        }

        .card-hijau {
            background-color: var(--hijau);
            color: white;
        }

        .card-kuning {
            background-color: var(--kuning);
            color: var(--hitam);
        }

        .card-merah {
            background-color: var(--merah);
            color: white;
        }

        .card-biru {
            background-color: var(--biru);
            color: white;
        }

        .card-hitam {
            background-color: var(--hitam);
            color: white;
        }

        .card-pattern {
            position: absolute;
            width: 100%;
            height: 100%;
            opacity: 0.1;
            background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="100" height="100" viewBox="0 0 100 100"><rect width="50" height="50" x="0" y="0" fill="black"/><rect width="50" height="50" x="50" y="50" fill="black"/></svg>');
            background-size: 20px 20px;
        }

        .game-actions {
            display: flex;
            justify-content: center;
            gap: 1rem;
            margin-top: 1rem;
        }

        .btn {
            padding: 0.75rem 1.5rem;
            border: none;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        .btn-primary {
            background-color: var(--hijau);
            color: white;
        }

        .btn-primary:hover {
            background-color: #3e8e41;
            transform: translateY(-2px);
        }

        .btn-secondary {
            background-color: var(--biru);
            color: white;
        }

        .btn-secondary:hover {
            background-color: #0d8bf2;
            transform: translateY(-2px);
        }

        .btn-danger {
            background-color: var(--merah);
            color: white;
        }

        .btn-danger:hover {
            background-color: #d32f2f;
            transform: translateY(-2px);
        }

        .modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.7);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 100;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.3s;
        }

        .modal.active {
            opacity: 1;
            pointer-events: all;
        }

        .modal-content {
            background-color: white;
            border-radius: 12px;
            width: 90%;
            max-width: 600px;
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
            transform: translateY(-20px);
            transition: transform 0.3s;
            padding: 2rem;
            position: relative;
        }

        .modal.active .modal-content {
            transform: translateY(0);
        }

        .close-modal {
            position: absolute;
            top: 1rem;
            right: 1rem;
            font-size: 1.5rem;
            cursor: pointer;
            background: none;
            border: none;
            color: var(--hitam);
        }

        .quiz-question {
            margin-bottom: 1.5rem;
        }

        .quiz-options {
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
        }

        .quiz-option {
            padding: 0.75rem;
            border: 2px solid var(--abu);
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.2s;
        }

        .quiz-option:hover {
            background-color: var(--abu);
        }

        .quiz-option.selected {
            background-color: var(--hijau);
            color: white;
            border-color: var(--hijau);
        }

        .quiz-result {
            text-align: center;
            margin-top: 1rem;
            font-weight: 600;
            min-height: 24px;
        }

        .progress-container {
            width: 100%;
            background-color: var(--abu);
            border-radius: 8px;
            margin: 1rem 0;
            height: 20px;
            overflow: hidden;
        }

        .progress-bar {
            height: 100%;
            background-color: var(--hijau);
            width: 0%;
            transition: width 0.5s;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 0.7rem;
            font-weight: 600;
        }

        .tabs {
            display: flex;
            border-bottom: 1px solid var(--abu);
            margin-bottom: 1rem;
        }

        .tab {
            padding: 0.75rem 1.5rem;
            cursor: pointer;
            border-bottom: 3px solid transparent;
            transition: all 0.3s;
        }

        .tab.active {
            border-bottom-color: var(--hijau);
            font-weight: 600;
            color: var(--hijau);
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        .leaderboard {
            width: 100%;
            border-collapse: collapse;
        }

        .leaderboard th, .leaderboard td {
            padding: 0.75rem;
            text-align: left;
            border-bottom: 1px solid var(--abu);
        }

        .leaderboard th {
            background-color: var(--hijau);
            color: white;
        }

        .leaderboard tr:nth-child(even) {
            background-color: var(--abu);
        }

        .leaderboard tr:hover {
            background-color: #d4edda;
        }

        .badge {
            display: inline-block;
            padding: 0.25rem 0.5rem;
            border-radius: 12px;
            font-size: 0.7rem;
            font-weight: 600;
            margin-left: 0.5rem;
        }

        .badge-primary {
            background-color: var(--hijau);
            color: white;
        }

        .badge-secondary {
            background-color: var(--biru);
            color: white;
        }

        .badge-warning {
            background-color: var(--kuning);
            color: var(--hitam);
        }

        .avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background-color: var(--abu);
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
            color: var(--hitam);
        }

        .edu-fact {
            background-color: var(--putih);
            border-radius: 8px;
            padding: 1rem;
            margin-bottom: 1rem;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            border-left: 4px solid var(--hijau);
        }

        .edu-fact h3 {
            color: var(--hijau);
            margin-bottom: 0.5rem;
        }

        .game-message {
            position: fixed;
            bottom: 2rem;
            left: 50%;
            transform: translateX(-50%);
            background-color: var(--hitam);
            color: white;
            padding: 1rem 2rem;
            border-radius: 8px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
            z-index: 50;
            opacity: 0;
            transition: opacity 0.3s;
        }

        .game-message.show {
            opacity: 1;
        }

        .color-selector {
            display: flex;
            gap: 1rem;
            justify-content: center;
            margin-top: 1rem;
        }

        .color-option {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            cursor: pointer;
            border: 3px solid transparent;
            transition: all 0.3s;
        }

        .color-option:hover {
            transform: scale(1.1);
        }

        .color-option.selected {
            border-color: white;
            box-shadow: 0 0 0 3px var(--hitam);
        }

        .tooltip {
            position: absolute;
            background-color: var(--hitam);
            color: white;
            padding: 0.5rem 1rem;
            border-radius: 8px;
            font-size: 0.8rem;
            z-index: 100;
            pointer-events: none;
            opacity: 0;
            transition: opacity 0.3s;
            max-width: 200px;
            text-align: center;
        }

        .tooltip::after {
            content: "";
            position: absolute;
            top: 100%;
            left: 50%;
            transform: translateX(-50%);
            border-width: 6px;
            border-style: solid;
            border-color: var(--hitam) transparent transparent transparent;
        }

        footer {
            background-color: var(--hitam);
            color: white;
            text-align: center;
            padding: 1.5rem;
            margin-top: 2rem;
        }

        @media (max-width: 768px) {
            .header-content {
                flex-direction: column;
                gap: 1rem;
            }

            nav ul {
                flex-direction: column;
                gap: 0.5rem;
                width: 100%;
                display: none;
            }

            nav ul.show {
                display: flex;
            }

            .hamburger {
                display: block;
            }

            .card {
                width: 60px;
                height: 90px;
                font-size: 0.8rem;
            }

            .discard-pile, .draw-pile {
                width: 60px;
                height: 90px;
            }

            .current-color {
                width: 30px;
                height: 30px;
            }

            .player-hand {
                gap: 5px;
            }

            .game-actions {
                flex-wrap: wrap;
            }

            .btn {
                padding: 0.5rem 1rem;
                font-size: 0.8rem;
            }
        }

        /* Animations */
        @keyframes cardDraw {
            0% { transform: translateY(0) rotate(0deg); }
            50% { transform: translateY(-50px) rotate(10deg); }
            100% { transform: translateY(0) rotate(0deg); }
        }

        .card-draw-animation {
            animation: cardDraw 0.5s ease-in-out;
        }

        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }

        .pulse {
            animation: pulse 1.5s infinite;
        }

        /* Dark mode toggle */
        .dark-mode-toggle {
            position: fixed;
            bottom: 1rem;
            right: 1rem;
            background-color: var(--hitam);
            color: white;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            cursor: pointer;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.2);
            z-index: 20;
        }

        body.dark-mode {
            background-color: #121212;
            color: #e0e0e0;
        }

        body.dark-mode .game-container {
            background-color: #1e1e1e;
            color: #e0e0e0;
        }

        body.dark-mode .edu-fact {
            background-color: #2d2d2d;
            color: #e0e0e0;
        }

        body.dark-mode .leaderboard tr:hover {
            background-color: #333;
        }
    </style>
</head>
<body>
    <header>
        <div class="header-content">
            <div class="logo">
                <img src="https://cdn-icons-png.flaticon.com/512/3097/3097138.png" alt="EcoUno Logo">
                <h1>EcoUno</h1>
            </div>
            <nav>
                <div class="hamburger">☰</div>
                <ul>
                    <li><a href="#" class="active">Beranda</a></li>
                    <li><a href="#" id="btn-learn">Belajar</a></li>
                    <li><a href="#" id="btn-leaderboard">Peringkat</a></li>
                    <li><a href="#" id="btn-profile">Profil</a></li>
                </ul>
            </nav>
        </div>
    </header>

    <main>
        <div class="game-container">
            <div class="game-header">
                <h2>Permainan EcoUno</h2>
                <div class="game-info">
                    <div class="player-info">
                        <span id="current-player">Giliran: Anda</span>
                    </div>
                    <div class="score">
                        Poin: <span id="player-score">0</span>
                    </div>
                </div>
            </div>

            <div class="game-board">
                <div class="opponents">
                    <div class="opponent">
                        <div class="opponent-name">Bot 1</div>
                        <div class="opponent-cards" id="bot1-cards">
                            <!-- Kartu bot akan ditambahkan oleh JavaScript -->
                        </div>
                    </div>
                    <div class="opponent">
                        <div class="opponent-name">Bot 2</div>
                        <div class="opponent-cards" id="bot2-cards">
                            <!-- Kartu bot akan ditambahkan oleh JavaScript -->
                        </div>
                    </div>
                    <div class="opponent">
                        <div class="opponent-name">Bot 3</div>
                        <div class="opponent-cards" id="bot3-cards">
                            <!-- Kartu bot akan ditambahkan oleh JavaScript -->
                        </div>
                    </div>
                </div>

                <div class="play-area">
                    <div class="draw-pile" id="draw-pile"></div>
                    <div class="discard-pile" id="discard-pile"></div>
                    <div class="current-color" id="current-color"></div>
                </div>

                <div class="player-hand" id="player-hand">
                    <!-- Kartu pemain akan ditambahkan oleh JavaScript -->
                </div>

                <div class="game-actions">
                    <button class="btn btn-primary" id="btn-play">Mainkan Kartu</button>
                    <button class="btn btn-secondary" id="btn-draw">Ambil Kartu</button>
                    <button class="btn btn-danger" id="btn-uno">UNO!</button>
                </div>
            </div>
        </div>
    </main>

    <!-- Modal untuk memilih warna -->
    <div class="modal" id="color-modal">
        <div class="modal-content">
            <button class="close-modal">&times;</button>
            <h2>Pilih Kategori Sampah</h2>
            <p>Anda memainkan kartu Wild. Silakan pilih kategori sampah untuk melanjutkan permainan.</p>
            <div class="color-selector">
                <div class="color-option card-hijau" data-color="hijau"></div>
                <div class="color-option card-kuning" data-color="kuning"></div>
                <div class="color-option card-merah" data-color="merah"></div>
                <div class="color-option card-biru" data-color="biru"></div>
            </div>
            <button class="btn btn-primary" id="btn-confirm-color">Konfirmasi</button>
        </div>
    </div>

    <!-- Modal untuk kuis edukasi -->
    <div class="modal" id="quiz-modal">
        <div class="modal-content">
            <button class="close-modal">&times;</button>
            <h2>Kuis Edukasi Lingkungan</h2>
            <div id="quiz-content">
                <!-- Konten kuis akan dimuat di sini -->
            </div>
            <div class="quiz-result" id="quiz-result"></div>
            <button class="btn btn-primary" id="btn-next-quiz" disabled>Lanjutkan</button>
        </div>
    </div>

    <!-- Modal untuk pusat pembelajaran -->
    <div class="modal" id="learn-modal">
        <div class="modal-content">
            <button class="close-modal">&times;</button>
            <h2>Pusat Pembelajaran EcoUno</h2>
            <div class="tabs">
                <div class="tab active" data-tab="organik">Organik</div>
                <div class="tab" data-tab="anorganik">Anorganik</div>
                <div class="tab" data-tab="b3">B3</div>
                <div class="tab" data-tab="residu">Residu</div>
            </div>
            <div class="tab-content active" id="tab-organik">
                <div class="edu-fact">
                    <h3>Apa itu Sampah Organik?</h3>
                    <p>Sampah organik adalah sampah yang berasal dari sisa makhluk hidup seperti tanaman, hewan, dan manusia yang dapat terurai secara alami oleh mikroorganisme. Contohnya: sisa makanan, daun, ranting, dan kotoran hewan.</p>
                </div>
                <div class="edu-fact">
                    <h3>Cara Mengelola Sampah Organik</h3>
                    <p>Sampah organik dapat diolah menjadi kompos melalui proses pengomposan. Kompos adalah pupuk alami yang sangat baik untuk tanaman. Anda juga bisa membuat lubang biopori di halaman untuk mengelola sampah organik.</p>
                </div>
                <div class="edu-fact">
                    <h3>Manfaat Pengolahan Sampah Organik</h3>
                    <p>Dengan mengolah sampah organik menjadi kompos, kita dapat mengurangi volume sampah di TPA, menghasilkan pupuk alami yang ramah lingkungan, dan meningkatkan kesuburan tanah.</p>
                </div>
            </div>
            <div class="tab-content" id="tab-anorganik">
                <div class="edu-fact">
                    <h3>Apa itu Sampah Anorganik?</h3>
                    <p>Sampah anorganik adalah sampah yang berasal dari bahan non-hayati, baik berupa produk sintetik maupun hasil proses teknologi pengolahan bahan tambang. Contohnya: plastik, kertas, logam, kaca, dan tekstil.</p>
                </div>
                <div class="edu-fact">
                    <h3>Cara Mengelola Sampah Anorganik</h3>
                    <p>Sampah anorganik sebaiknya dipilah berdasarkan jenisnya (plastik, kertas, logam, dll) dan dibawa ke bank sampah atau tempat daur ulang. Beberapa sampah anorganik juga bisa dimanfaatkan kembali (reuse) untuk keperluan lain.</p>
                </div>
                <div class="edu-fact">
                    <h3>Fakta Menarik tentang Daur Ulang</h3>
                    <p>Daur ulang 1 ton kertas dapat menyelamatkan 17 pohon dewasa. Satu botol plastik yang didaur ulang dapat menghemat energi cukup untuk menyalakan bola lampu 60-watt selama 6 jam.</p>
                </div>
            </div>
            <div class="tab-content" id="tab-b3">
                <div class="edu-fact">
                    <h3>Apa itu Sampah B3?</h3>
                    <p>Sampah B3 (Bahan Berbahaya dan Beracun) adalah sampah yang mengandung bahan berbahaya dan/atau beracun yang karena sifat dan/atau konsentrasinya dapat mencemarkan dan/atau merusak lingkungan hidup. Contohnya: baterai, obat kadaluarsa, pestisida, dan bahan kimia rumah tangga.</p>
                </div>
                <div class="edu-fact">
                    <h3>Cara Mengelola Sampah B3</h3>
                    <p>Sampah B3 tidak boleh dibuang sembarangan karena berbahaya. Kumpulkan sampah B3 rumah tangga seperti baterai dan lampu neon di tempat khusus, lalu serahkan ke tempat pengumpulan sampah B3 atau dropbox yang disediakan pemerintah.</p>
                </div>
                <div class="edu-fact">
                    <h3>Dampak Sampah B3</h3>
                    <p>Sampah B3 yang tidak dikelola dengan benar dapat mencemari tanah dan air, membahayakan kesehatan manusia, serta merusak ekosistem. Satu baterai kecil bisa mencemari 400 liter air!</p>
                </div>
            </div>
            <div class="tab-content" id="tab-residu">
                <div class="edu-fact">
                    <h3>Apa itu Sampah Residu?</h3>
                    <p>Sampah residu adalah sampah yang tidak dapat didaur ulang atau diolah kembali dengan teknologi yang tersedia saat ini. Contohnya: popok sekali pakai, pembalut, permen karet, dan bungkus makanan yang terkontaminasi.</p>
                </div>
                <div class="edu-fact">
                    <h3>Cara Mengelola Sampah Residu</h3>
                    <p>Sampah residu harus dibuang ke tempat pembuangan akhir (TPA). Namun, kita bisa mengurangi produksi sampah residu dengan memilih produk yang bisa digunakan kembali (reusable) daripada yang sekali pakai.</p>
                </div>
                <div class="edu-fact">
                    <h3>Fakta tentang Sampah Residu</h3>
                    <p>Popok bayi sekali pakai membutuhkan waktu sekitar 500 tahun untuk terurai di alam. Setiap tahun, miliaran popok sekali pakai berakhir di TPA dan mencemari lingkungan.</p>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal untuk leaderboard -->
    <div class="modal" id="leaderboard-modal">
        <div class="modal-content">
            <button class="close-modal">&times;</button>
            <h2>Papan Peringkat EcoUno</h2>
            <table class="leaderboard">
                <thead>
                    <tr>
                        <th>Peringkat</th>
                        <th>Pemain</th>
                        <th>Poin</th>
                        <th>Level</th>
                    </tr>
                </thead>
                <tbody id="leaderboard-body">
                    <tr>
                        <td>1</td>
                        <td>
                            <div class="avatar" style="background-color: #FFC107;">A</div>
                            <span>Anda</span>
                            <span class="badge badge-primary">Anda</span>
                        </td>
                        <td>1250</td>
                        <td>7 <span class="badge badge-warning">Ahli</span></td>
                    </tr>
                    <tr>
                        <td>2</td>
                        <td>
                            <div class="avatar" style="background-color: #4CAF50;">B</div>
                            <span>Budi_Eco</span>
                        </td>
                        <td>980</td>
                        <td>6</td>
                    </tr>
                    <tr>
                        <td>3</td>
                        <td>
                            <div class="avatar" style="background-color: #2196F3;">C</div>
                            <span>CintaBumi</span>
                        </td>
                        <td>875</td>
                        <td>5</td>
                    </tr>
                    <tr>
                        <td>4</td>
                        <td>
                            <div class="avatar" style="background-color: #F44336;">D</div>
                            <span>DaurUlang</span>
                        </td>
                        <td>760</td>
                        <td>5</td>
                    </tr>
                    <tr>
                        <td>5</td>
                        <td>
                            <div class="avatar" style="background-color: #9C27B0;">E</div>
                            <span>EkoWarrior</span>
                        </td>
                        <td>650</td>
                        <td>4</td>
                    </tr>
                </tbody>
            </table>
            <div class="progress-container">
                <div class="progress-bar" style="width: 65%;">65% menuju Level 8</div>
            </div>
        </div>
    </div>

    <!-- Modal untuk profil -->
    <div class="modal" id="profile-modal">
        <div class="modal-content">
            <button class="close-modal">&times;</button>
            <h2>Profil Pemain</h2>
            <div style="display: flex; gap: 1.5rem; align-items: center; margin-bottom: 1.5rem;">
                <div class="avatar" style="width: 80px; height: 80px; font-size: 2rem; background-color: #FFC107;">A</div>
                <div>
                    <h3>Anda</h3>
                    <p>Bergabung sejak: 15 Juli 2023</p>
                    <span class="badge badge-primary">Level 7</span>
                    <span class="badge badge-secondary">Ahli Daur Ulang</span>
                </div>
            </div>
            <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 1rem; margin-bottom: 1.5rem;">
                <div style="background-color: #f5f5f5; padding: 1rem; border-radius: 8px;">
                    <h4>Total Poin</h4>
                    <p style="font-size: 1.5rem; font-weight: 700; color: var(--hijau);">1,250</p>
                </div>
                <div style="background-color: #f5f5f5; padding: 1rem; border-radius: 8px;">
                    <h4>Permainan Dimainkan</h4>
                    <p style="font-size: 1.5rem; font-weight: 700; color: var(--biru);">42</p>
                </div>
                <div style="background-color: #f5f5f5; padding: 1rem; border-radius: 8px;">
    <h4>Kuis Dijawab</h4>
    <p style="font-size: 1.5rem; font-weight: 700; color: var(--biru);">128</p>
</div>
<div style="background-color: #f5f5f5; padding: 1rem; border-radius: 8px;">
                    <h4>Rasio Menang</h4>
                <p style="font-size: 1.5rem; font-weight: 700; color: var(--kuning);">78%</p>
            </div>
            <div style="background-color: #f5f5f5; padding: 1rem; border-radius: 8px;">
                <h4>Poin Lingkungan</h4>
                <p style="font-size: 1.5rem; font-weight: 700; color: var(--merah);">3,450</p>
            </div>
        </div>
        <h3>Pencapaian</h3>
        <div style="display: flex; flex-wrap: wrap; gap: 0.5rem; margin-bottom: 1.5rem;">
            <span class="badge badge-primary">Pemula Hijau</span>
            <span class="badge badge-primary">Daur Ulang 10x</span>
            <span class="badge badge-primary">Ahli Kuis</span>
            <span class="badge badge-warning">Pemenang 5x</span>
            <span class="badge badge-secondary">Level 5</span>
        </div>
        <h3>Statistik Kategori</h3>
        <div style="margin-bottom: 1rem;">
            <p>Organik <progress value="75" max="100" style="width: 100%;"></progress></p>
            <p>Anorganik <progress value="60" max="100" style="width: 100%;"></progress></p>
            <p>B3 <progress value="45" max="100" style="width: 100%;"></progress></p>
            <p>Residu <progress value="30" max="100" style="width: 100%;"></progress></p>
        </div>
        <button class="btn btn-primary" style="width: 100%;">Edit Profil</button>
    </div>
</div>

<!-- Pesan permainan -->
<div class="game-message" id="game-message"></div>

<!-- Tooltip -->
<div class="tooltip" id="tooltip"></div>

<!-- Dark mode toggle -->
<div class="dark-mode-toggle" id="dark-mode-toggle">🌓</div>

<footer>
    <p>© 2023 EcoUno - Game Edukasi Pemilahan Sampah</p>
    <p>Bersama kita jaga bumi untuk masa depan yang lebih baik</p>
</footer>

<script>
    // Data game
    const gameData = {
        players: [
            { id: 0, name: "Anda", isHuman: true, cards: [], score: 0 },
            { id: 1, name: "Bot 1", isHuman: false, cards: [], score: 0 },
            { id: 2, name: "Bot 2", isHuman: false, cards: [], score: 0 },
            { id: 3, name: "Bot 3", isHuman: false, cards: [], score: 0 }
        ],
        currentPlayer: 0,
        direction: 1, // 1 for clockwise, -1 for counter-clockwise
        drawPile: [],
        discardPile: [],
        currentColor: null,
        selectedCard: null,
        unoCalled: false,
        gameStarted: false,
        playerScore: 0,
        quizQuestions: [
            {
                question: "Manakah yang termasuk sampah organik?",
                options: [
                    "Botol plastik",
                    "Kulit pisang",
                    "Baterai",
                    "Kaca"
                ],
                answer: 1,
                fact: "Sampah organik seperti kulit pisang dapat terurai secara alami dan baik untuk kompos."
            },
            {
                question: "Berapa lama waktu yang dibutuhkan plastik untuk terurai di alam?",
                options: [
                    "5-10 tahun",
                    "20-50 tahun",
                    "100-200 tahun",
                    "450 tahun atau lebih"
                ],
                answer: 3,
                fact: "Plastik bisa membutuhkan waktu hingga 450 tahun untuk terurai sepenuhnya!"
            },
            {
                question: "Apa yang harus dilakukan dengan sampah B3 seperti baterai?",
                options: [
                    "Buang ke tempat sampah biasa",
                    "Kubur di tanah",
                    "Bakar saja",
                    "Bawa ke tempat pengumpulan sampah B3"
                ],
                answer: 3,
                fact: "Sampah B3 mengandung bahan berbahaya dan harus dikelola secara khusus."
            },
            {
                question: "Apa manfaat utama dari daur ulang kertas?",
                options: [
                    "Menghemat air",
                    "Mengurangi penebangan pohon",
                    "Menghemat energi",
                    "Semua jawaban benar"
                ],
                answer: 3,
                fact: "Daur ulang kertas menghemat 70% energi, 50% air, dan menyelamatkan banyak pohon."
            },
            {
                question: "Manakah yang bukan termasuk 3R dalam pengelolaan sampah?",
                options: [
                    "Reduce",
                    "Reuse",
                    "Recycle",
                    "Remove"
                ],
                answer: 3,
                fact: "3R adalah Reduce (mengurangi), Reuse (menggunakan kembali), dan Recycle (mendaur ulang)."
            }
        ],
        cardFacts: {
            hijau: {
                0: "Sampah organik dapat diolah menjadi kompos yang menyuburkan tanah.",
                1: "1 kg sampah organik bisa menghasilkan 0.5 kg kompos berkualitas.",
                2: "Kompos dari sampah organik mengurangi kebutuhan pupuk kimia.",
                3: "Sampah organik yang dibuang sembarangan bisa menghasilkan gas metana.",
                4: "Membuat kompos di rumah bisa mengurangi 30% volume sampah Anda.",
                5: "Sampah organik di TPA menyumbang 60% dari total sampah.",
                6: "Kompos memperbaiki struktur tanah dan menyimpan air lebih baik.",
                7: "Sampah dapur organik sebaiknya dipisahkan sejak awal.",
                8: "Daun kering adalah bahan kompos yang sangat baik.",
                9: "Kompos matang memiliki tekstur seperti tanah dan bau tanah."
            },
            kuning: {
                0: "Plastik PET (botol minuman) bisa didaur ulang menjadi kain polyester.",
                1: "Daur ulang 1 ton kertas menyelamatkan 17 pohon dewasa.",
                2: "Kaleng aluminium bisa didaur ulang tanpa batas waktu.",
                3: "Kaca bisa didaur ulang 100% tanpa kehilangan kualitas.",
                4: "Plastik HDPE (botol sampo) bisa didaur ulang menjadi pipa.",
                5: "Daur ulang mengurangi energi hingga 95% untuk aluminium.",
                6: "1 ton plastik daur ulang menghemat 5.774 kWh energi.",
                7: "Kertas daur ulang menghemat 70% energi dibanding kertas baru.",
                8: "Plastik PP (tutup botol) bisa didaur ulang menjadi ember.",
                9: "Daur ulang kaca mengurangi polusi udara 20% dan polusi air 50%."
            },
            merah: {
                0: "1 baterai kecil bisa mencemari 400 liter air!",
                1: "Lampu neon mengandung merkuri yang sangat berbahaya.",
                2: "Obat kadaluarsa tidak boleh dibuang ke toilet atau wastafel.",
                3: "Pestisida termasuk limbah B3 yang beracun.",
                4: "Aki kendaraan harus didaur ulang secara khusus.",
                5: "Baterai lithium bisa meledak jika tidak ditangani dengan benar.",
                6: "Minyak goreng bekas bisa mencemari air jika dibuang sembarangan.",
                7: "Kain lap bekas bahan kimia termasuk limbah B3.",
                8: "Termometer merkuri sudah dilarang karena bahayanya.",
                9: "Limbah elektronik mengandung logam berat berbahaya."
            },
            biru: {
                0: "Popok sekali pakai membutuhkan 500 tahun untuk terurai.",
                1: "Pembalut wanita konvensional mengandung plastik yang sulit terurai.",
                2: "Permen karet mengandung bahan sintetik yang tidak bisa terurai.",
                3: "Bungkus makanan berminyak tidak bisa didaur ulang.",
                4: "Kantong plastik multilayer sulit didaur ulang.",
                5: "Bungkus kopi sachet termasuk residu karena multilayer.",
                6: "Tisu basah mengandung plastik dan tidak bisa terurai.",
                7: "Stiker buah biasanya mengandung plastik dan perekat.",
                8: "Pembungkus makanan yang kotor termasuk residu.",
                9: "Kemasan yang terkontaminasi makanan termasuk residu."
            }
        }
    };

    // Inisialisasi game
    function initGame() {
        createDeck();
        shuffleDeck();
        dealCards();
        startGame();
        setupEventListeners();
        updateUI();
    }

    // Membuat dek kartu
    function createDeck() {
        const colors = ['hijau', 'kuning', 'merah', 'biru'];
        const specialCards = ['skip', 'reverse', 'draw2'];
        
        colors.forEach(color => {
            // Tambahkan kartu angka 0-9 (dua set kecuali 0)
            for (let i = 0; i <= 9; i++) {
                gameData.drawPile.push({ color, value: i, type: 'number' });
                if (i !== 0) {
                    gameData.drawPile.push({ color, value: i, type: 'number' });
                }
            }
            
            // Tambahkan kartu spesial (dua set per warna)
            specialCards.forEach(type => {
                gameData.drawPile.push({ color, value: type, type: 'special' });
                gameData.drawPile.push({ color, value: type, type: 'special' });
            });
        });
        
        // Tambahkan kartu wild (empat set)
        for (let i = 0; i < 4; i++) {
            gameData.drawPile.push({ color: 'hitam', value: 'wild', type: 'wild' });
            gameData.drawPile.push({ color: 'hitam', value: 'draw4', type: 'wild' });
        }
    }

    // Mengacak dek kartu
    function shuffleDeck() {
        for (let i = gameData.drawPile.length - 1; i > 0; i--) {
            const j = Math.floor(Math.random() * (i + 1));
            [gameData.drawPile[i], gameData.drawPile[j]] = [gameData.drawPile[j], gameData.drawPile[i]];
        }
    }

    // Membagikan kartu ke pemain
    function dealCards() {
        gameData.players.forEach(player => {
            player.cards = [];
            for (let i = 0; i < 7; i++) {
                player.cards.push(drawCard());
            }
        });
        
        // Letakkan kartu pertama di discard pile
        let firstCard;
        do {
            firstCard = drawCard();
        } while (firstCard.type === 'wild'); // Pastikan bukan wild card
        
        gameData.discardPile.push(firstCard);
        gameData.currentColor = firstCard.color;
    }

    // Mengambil kartu dari draw pile
    function drawCard() {
        if (gameData.drawPile.length === 0) {
            // Jika draw pile habis, buat baru dari discard pile (kecuali kartu teratas)
            const topCard = gameData.discardPile.pop();
            gameData.drawPile = [...gameData.discardPile];
            gameData.discardPile = [topCard];
            shuffleDeck();
        }
        return gameData.drawPile.pop();
    }

    // Memulai permainan
    function startGame() {
        gameData.gameStarted = true;
        gameData.currentPlayer = Math.floor(Math.random() * gameData.players.length);
        showMessage(`Permainan dimulai! Giliran pertama: ${gameData.players[gameData.currentPlayer].name}`);
    }

    // Mengatur event listeners
    function setupEventListeners() {
        // Tombol aksi permainan
        document.getElementById('btn-play').addEventListener('click', playSelectedCard);
        document.getElementById('btn-draw').addEventListener('click', drawCardForPlayer);
        document.getElementById('btn-uno').addEventListener('click', callUno);
        
        // Modal
        document.querySelectorAll('.close-modal').forEach(btn => {
            btn.addEventListener('click', () => {
                document.querySelectorAll('.modal').forEach(modal => {
                    modal.classList.remove('active');
                });
            });
        });
        
        // Pilih warna
        document.querySelectorAll('.color-option').forEach(option => {
            option.addEventListener('click', function() {
                document.querySelectorAll('.color-option').forEach(opt => opt.classList.remove('selected'));
                this.classList.add('selected');
            });
        });
        
        document.getElementById('btn-confirm-color').addEventListener('click', confirmColorSelection);
        
        // Navigasi
        document.getElementById('btn-learn').addEventListener('click', () => {
            document.getElementById('learn-modal').classList.add('active');
        });
        
        document.getElementById('btn-leaderboard').addEventListener('click', () => {
            document.getElementById('leaderboard-modal').classList.add('active');
        });
        
        document.getElementById('btn-profile').addEventListener('click', () => {
            document.getElementById('profile-modal').classList.add('active');
        });
        
        // Tab pembelajaran
        document.querySelectorAll('.tab').forEach(tab => {
            tab.addEventListener('click', function() {
                const tabId = this.getAttribute('data-tab');
                document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
                document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
                this.classList.add('active');
                document.getElementById(`tab-${tabId}`).classList.add('active');
            });
        });
        
        // Hamburger menu
        document.querySelector('.hamburger').addEventListener('click', () => {
            document.querySelector('nav ul').classList.toggle('show');
        });
        
        // Dark mode toggle
        document.getElementById('dark-mode-toggle').addEventListener('click', () => {
            document.body.classList.toggle('dark-mode');
            const icon = document.getElementById('dark-mode-toggle');
            if (document.body.classList.contains('dark-mode')) {
                icon.textContent = '☀️';
            } else {
                icon.textContent = '🌓';
            }
        });
        
        // Kuis
        document.getElementById('btn-next-quiz').addEventListener('click', nextQuizAction);
    }

    // Memperbarui UI
    function updateUI() {
        // Update info pemain saat ini
        document.getElementById('current-player').textContent = `Giliran: ${gameData.players[gameData.currentPlayer].name}`;
        
        // Update skor
        document.getElementById('player-score').textContent = gameData.playerScore;
        
        // Update kartu pemain
        const playerHand = document.getElementById('player-hand');
        playerHand.innerHTML = '';
        
        gameData.players[0].cards.forEach((card, index) => {
            const cardElement = createCardElement(card, index);
            playerHand.appendChild(cardElement);
        });
        
        // Update kartu bot
        updateBotCards();
        
        // Update discard pile
        const discardPile = document.getElementById('discard-pile');
        discardPile.innerHTML = '';
        
        if (gameData.discardPile.length > 0) {
            const topCard = gameData.discardPile[gameData.discardPile.length - 1];
            discardPile.appendChild(createCardElement(topCard, -1, false));
            discardPile.className = `discard-pile card-${topCard.color}`;
        }
        
        // Update draw pile
        const drawPile = document.getElementById('draw-pile');
        drawPile.innerHTML = '';
        drawPile.className = 'draw-pile';
        
        // Update current color indicator
        const currentColor = document.getElementById('current-color');
        currentColor.className = `current-color card-${gameData.currentColor}`;
        
        // Enable/disable tombol berdasarkan giliran
        const isPlayerTurn = gameData.currentPlayer === 0;
        document.getElementById('btn-play').disabled = !isPlayerTurn || !gameData.selectedCard;
        document.getElementById('btn-draw').disabled = !isPlayerTurn;
        document.getElementById('btn-uno').disabled = !isPlayerTurn || gameData.players[0].cards.length !== 1;
        
        // Highlight kartu yang dipilih
        document.querySelectorAll('.card').forEach(card => {
            card.classList.remove('selected');
            const cardIndex = parseInt(card.getAttribute('data-index'));
            if (cardIndex === gameData.selectedCard) {
                card.classList.add('selected');
            }
        });
    }

    // Membuat elemen kartu
    function createCardElement(card, index, isPlayable = true) {
        const cardElement = document.createElement('div');
        cardElement.className = `card card-${card.color}`;
        cardElement.setAttribute('data-index', index);
        
        if (isPlayable) {
            cardElement.addEventListener('click', () => selectCard(index));
            
            // Tooltip untuk fakta edukasi
            cardElement.addEventListener('mouseenter', (e) => {
                if (card.type === 'number') {
                    const tooltip = document.getElementById('tooltip');
                    const fact = gameData.cardFacts[card.color][card.value];
                    tooltip.textContent = fact;
                    tooltip.style.left = `${e.pageX}px`;
                    tooltip.style.top = `${e.pageY - 50}px`;
                    tooltip.style.opacity = '1';
                }
            });
            
            cardElement.addEventListener('mouseleave', () => {
                document.getElementById('tooltip').style.opacity = '0';
            });
        }
        
        // Konten kartu
        if (card.type === 'number') {
            cardElement.innerHTML = `
                <div class="card-number">${card.value}</div>
                <div class="card-icon">${getCardIcon(card)}</div>
                <div class="card-label">${getCardLabel(card)}</div>
                <div class="card-pattern"></div>
            `;
        } else if (card.type === 'special') {
            cardElement.innerHTML = `
                <div class="card-icon" style="font-size: 1.5rem; margin: auto;">${getCardIcon(card)}</div>
                <div class="card-label">${getCardLabel(card)}</div>
                <div class="card-pattern"></div>
            `;
        } else { // wild card
            cardElement.innerHTML = `
                <div class="card-icon" style="font-size: 1.5rem; margin: auto;">${getCardIcon(card)}</div>
                <div class="card-label">${getCardLabel(card)}</div>
                <div class="card-pattern"></div>
            `;
        }
        
        return cardElement;
    }

    // Mendapatkan ikon kartu
    function getCardIcon(card) {
        const icons = {
            hijau: ['🍎', '🍌', '🥦', '🍂', '🥕', '🌽', '🍊', '🥬', '🍑', '🥥'],
            kuning: ['🧴', '📦', '🥫', '🧃', '🧊', '📰', '📚', '🧻', '🛍️', '🧂'],
            merah: ['🔋', '💡', '🧪', '🧴', '🛢️', '💊', '🧼', '🧽', '🌡️', '📱'],
            biru: ['🧷', '🧻', '🍬', '🍱', '☕', '🧻', '🧼', '🍎', '🍔', '🥡']
        };
        
        if (card.type === 'number') {
            return icons[card.color][card.value];
        } else if (card.type === 'special') {
            switch (card.value) {
                case 'skip': return '⛔';
                case 'reverse': return '🔄';
                case 'draw2': return '➕2️⃣';
            }
        } else {
            switch (card.value) {
                case 'wild': return '🌈';
                case 'draw4': return '➕4️⃣';
            }
        }
        return '❓';
    }

    // Mendapatkan label kartu
    function getCardLabel(card) {
        const labels = {
            hijau: 'Organik',
            kuning: 'Anorganik',
            merah: 'B3',
            biru: 'Residu'
        };
        
        if (card.type === 'number') {
            return labels[card.color];
        } else if (card.type === 'special') {
            switch (card.value) {
                case 'skip': return 'Hentikan Pembuangan Ilegal';
                case 'reverse': return 'Putar Arah Daur Ulang';
                case 'draw2': return 'Tumpukan Sampah';
            }
        } else {
            switch (card.value) {
                case 'wild': return 'Pilih Kategori';
                case 'draw4': return 'Bencana Sampah';
            }
        }
        return '';
    }

    // Memperbarui tampilan kartu bot
    function updateBotCards() {
        gameData.players.slice(1).forEach((player, index) => {
            const botCardsContainer = document.getElementById(`bot${index+1}-cards`);
            botCardsContainer.innerHTML = '';
            
            for (let i = 0; i < player.cards.length; i++) {
                const cardElement = document.createElement('div');
                cardElement.className = 'opponent-card';
                botCardsContainer.appendChild(cardElement);
            }
        });
    }

    // Memilih kartu
    function selectCard(index) {
        if (gameData.currentPlayer === 0) {
            const card = gameData.players[0].cards[index];
            
            // Periksa apakah kartu bisa dimainkan
            const topCard = gameData.discardPile[gameData.discardPile.length - 1];
            if (canPlayCard(card, topCard)) {
                if (gameData.selectedCard === index) {
                    gameData.selectedCard = null;
                } else {
                    gameData.selectedCard = index;
                }
                updateUI();
            } else {
                showMessage('Kartu ini tidak bisa dimainkan sekarang!');
            }
        }
    }

    // Memeriksa apakah kartu bisa dimainkan
    function canPlayCard(card, topCard) {
        return card.color === gameData.currentColor || 
               card.color === topCard.color || 
               card.type === 'wild' || 
               (card.type === 'number' && card.value === topCard.value) || 
               (card.type === 'special' && card.value === topCard.value);
    }

    // Memainkan kartu yang dipilih
    function playSelectedCard() {
        if (gameData.selectedCard !== null && gameData.currentPlayer === 0) {
            const card = gameData.players[0].cards[gameData.selectedCard];
            playCard(0, card);
        }
    }

    // Memainkan kartu
    function playCard(playerIndex, card) {
        const player = gameData.players[playerIndex];
        
        // Hapus kartu dari tangan pemain
        player.cards = player.cards.filter((c, i) => i !== gameData.selectedCard);
        gameData.selectedCard = null;
        
        // Tambahkan ke discard pile
        gameData.discardPile.push(card);
        
        // Update current color
        if (card.type !== 'wild') {
            gameData.currentColor = card.color;
        } else {
            // Untuk wild card, pemain harus memilih warna
            if (player.isHuman) {
                showColorSelectionModal();
                return;
            } else {
                // Bot memilih warna secara acak (bukan hitam)
                const colors = ['hijau', 'kuning', 'merah', 'biru'];
                gameData.currentColor = colors[Math.floor(Math.random() * colors.length)];
            }
        }
        
        // Handle efek kartu spesial
        handleSpecialCard(card);
        
        // Periksa apakah pemain menang
        if (player.cards.length === 0) {
            endGame(playerIndex);
            return;
        }
        
        // Pindah ke pemain berikutnya
        nextPlayer();
        
        // Jika giliran bot, biarkan bot bermain
        if (!gameData.players[gameData.currentPlayer].isHuman) {
            setTimeout(botPlay, 1500);
        }
        
        updateUI();
    }

    // Menangani kartu spesial
    function handleSpecialCard(card) {
        const nextPlayerIndex = getNextPlayer();
        
        switch (card.value) {
            case 'skip':
                showMessage(`${gameData.players[nextPlayerIndex].name} dilewati karena pembuangan ilegal!`);
                nextPlayer();
                break;
                
            case 'reverse':
                gameData.direction *= -1;
                showMessage(`Arah daur ulang berubah! Sekarang bermain ${gameData.direction === 1 ? 'searah jarum jam' : 'berlawanan arah jarum jam'}`);
                break;
                
            case 'draw2':
                const draw2Player = gameData.players[nextPlayerIndex];
                draw2Player.cards.push(drawCard());
                draw2Player.cards.push(drawCard());
                showMessage(`${draw2Player.name} mengambil 2 kartu karena tumpukan sampah!`);
                break;
                
            case 'draw4':
                const draw4Player = gameData.players[nextPlayerIndex];
                for (let i = 0; i < 4; i++) {
                    draw4Player.cards.push(drawCard());
                }
                showMessage(`${draw4Player.name} mengambil 4 kartu karena bencana sampah!`);
                break;
        }
    }

    // Menampilkan modal pemilihan warna
    function showColorSelectionModal() {
        document.getElementById('color-modal').classList.add('active');
    }

    // Konfirmasi pemilihan warna
    function confirmColorSelection() {
        const selectedColor = document.querySelector('.color-option.selected').getAttribute('data-color');
        gameData.currentColor = selectedColor;
        document.getElementById('color-modal').classList.remove('active');
        
        // Lanjutkan permainan
        const nextPlayerIndex = getNextPlayer();
        
        // Handle efek draw4 jika ada
        const card = gameData.discardPile[gameData.discardPile.length - 1];
        if (card.value === 'draw4') {
            const draw4Player = gameData.players[nextPlayerIndex];
            for (let i = 0; i < 4; i++) {
                draw4Player.cards.push(drawCard());
            }
            showMessage(`${draw4Player.name} mengambil 4 kartu karena bencana sampah!`);
        }
        
        nextPlayer();
        
        // Jika giliran bot, biarkan bot bermain
        if (!gameData.players[gameData.currentPlayer].isHuman) {
            setTimeout(botPlay, 1500);
        }
        
        updateUI();
    }

    // Mengambil kartu untuk pemain
    function drawCardForPlayer() {
        if (gameData.currentPlayer === 0) {
            const card = drawCard();
            gameData.players[0].cards.push(card);
            showMessage(`Anda mengambil 1 kartu`);
            
            // Animasi kartu baru
            const cardElements = document.querySelectorAll('.card');
            if (cardElements.length > 0) {
                cardElements[cardElements.length - 1].classList.add('card-draw-animation');
                setTimeout(() => {
                    cardElements[cardElements.length - 1].classList.remove('card-draw-animation');
                }, 500);
            }
            
            // Pindah ke pemain berikutnya
            nextPlayer();
            
            // Jika giliran bot, biarkan bot bermain
            if (!gameData.players[gameData.currentPlayer].isHuman) {
                setTimeout(botPlay, 1500);
            }
            
            updateUI();
        }
    }

    // Memanggil UNO
    function callUno() {
        if (gameData.currentPlayer === 0 && gameData.players[0].cards.length === 1) {
            gameData.unoCalled = true;
            showMessage('UNO! Anda tinggal 1 kartu!');
        }
    }

    // Pindah ke pemain berikutnya
    function nextPlayer() {
        gameData.currentPlayer = getNextPlayer();
        gameData.unoCalled = false;
    }

    // Mendapatkan index pemain berikutnya
    function getNextPlayer() {
        let nextPlayer = gameData.currentPlayer + gameData.direction;
        
        if (nextPlayer >= gameData.players.length) {
            nextPlayer = 0;
        } else if (nextPlayer < 0) {
            nextPlayer = gameData.players.length - 1;
        }
        
        return nextPlayer;
    }

    // Bot bermain
    function botPlay() {
        const bot = gameData.players[gameData.currentPlayer];
        const topCard = gameData.discardPile[gameData.discardPile.length - 1];
        
        // Cari kartu yang bisa dimainkan
        let playableCardIndex = -1;
        for (let i = 0; i < bot.cards.length; i++) {
            if (canPlayCard(bot.cards[i], topCard)) {
                playableCardIndex = i;
                break;
            }
        }
        
        if (playableCardIndex !== -1) {
            // Mainkan kartu
            const card = bot.cards[playableCardIndex];
            bot.cards.splice(playableCardIndex, 1);
            gameData.discardPile.push(card);
            
            // Update current color
            if (card.type !== 'wild') {
                gameData.currentColor = card.color;
            } else {
                // Bot memilih warna secara acak (bukan hitam)
                const colors = ['hijau', 'kuning', 'merah', 'biru'];
                gameData.currentColor = colors[Math.floor(Math.random() * colors.length)];
                showMessage(`${bot.name} memilih kategori ${gameData.currentColor}`);
            }
            
            // Handle efek kartu spesial
            handleSpecialCard(card);
            
            // Periksa apakah bot menang
            if (bot.cards.length === 0) {
                endGame(gameData.currentPlayer);
                return;
            }
            
            // Jika bot tinggal 1 kartu, ada 50% kemungkinan memanggil UNO
            if (bot.cards.length === 1 && Math.random() > 0.5) {
                showMessage(`UNO! ${bot.name} tinggal 1 kartu!`);
            }
        } else {
            // Ambil kartu
            const card = drawCard();
            bot.cards.push(card);
            showMessage(`${bot.name} mengambil 1 kartu`);
            
            // Jika kartu yang diambil bisa dimainkan, mainkan
            if (canPlayCard(card, topCard)) {
                setTimeout(() => {
                    bot.cards.pop();
                    gameData.discardPile.push(card);
                    
                    if (card.type !== 'wild') {
                        gameData.currentColor = card.color;
                    } else {
                        const colors = ['hijau', 'kuning', 'merah', 'biru'];
                        gameData.currentColor = colors[Math.floor(Math.random() * colors.length)];
                        showMessage(`${bot.name} memilih kategori ${gameData.currentColor}`);
                    }
                    
                    handleSpecialCard(card);
                    
                    if (bot.cards.length === 0) {
                        endGame(gameData.currentPlayer);
                        return;
                    }
                    
                    nextPlayer();
                    
                    // Jika giliran bot lagi, biarkan bermain
                    if (!gameData.players[gameData.currentPlayer].isHuman) {
                        setTimeout(botPlay, 1500);
                    }
                    
                    updateUI();
                }, 1000);
                return;
            }
        }
        
        nextPlayer();
        
        // Jika giliran bot lagi, biarkan bermain
        if (!gameData.players[gameData.currentPlayer].isHuman) {
            setTimeout(botPlay, 1500);
        }
        
        updateUI();
    }

    // Mengakhiri permainan
    function endGame(winnerIndex) {
        const winner = gameData.players[winnerIndex];
        showMessage(`${winner.name} menang! Permainan berakhir.`);
        
        // Hitung poin untuk pemain manusia
        if (winnerIndex === 0) {
            let points = 0;
            gameData.players.slice(1).forEach(player => {
                player.cards.forEach(card => {
                    points += getCardPoints(card);
                });
            });
            
            gameData.playerScore += points;
            showMessage(`Anda mendapatkan ${points} poin! Total poin: ${gameData.playerScore}`);
            
            // Tampilkan kuis edukasi
            setTimeout(showQuiz, 2000);
        }
        
        // Reset game state
        gameData.gameStarted = false;
        gameData.selectedCard = null;
        
        // Tampilkan tombol mulai baru
        document.getElementById('btn-play').textContent = 'Mulai Permainan Baru';
        document.getElementById('btn-play').removeEventListener('click', playSelectedCard);
        document.getElementById('btn-play').addEventListener('click', initGame);
    }

    // Mendapatkan poin kartu
    function getCardPoints(card) {
        if (card.type === 'number') {
            return card.value;
        } else if (card.type === 'special') {
            return 20;
        } else { // wild card
            return 50;
        }
    }

    // Menampilkan kuis edukasi
    function showQuiz() {
        const quizModal = document.getElementById('quiz-modal');
        const quizContent = document.getElementById('quiz-content');
        const quizResult = document.getElementById('quiz-result');
        const nextButton = document.getElementById('btn-next-quiz');
        
        // Pilih pertanyaan acak
        const randomQuestion = gameData.quizQuestions[Math.floor(Math.random() * gameData.quizQuestions.length)];
        
        // Tampilkan pertanyaan
        quizContent.innerHTML = `
            <div class="quiz-question">
                <h3>${randomQuestion.question}</h3>
            </div>
            <div class="quiz-options">
                ${randomQuestion.options.map((option, index) => `
                    <div class="quiz-option" data-index="${index}">${option}</div>
                `).join('')}
            </div>
        `;
        
        // Reset state
        quizResult.textContent = '';
        nextButton.disabled = true;
        nextButton.setAttribute('data-correct-index', randomQuestion.answer);
        nextButton.setAttribute('data-fact', randomQuestion.fact);
        
        // Tambahkan event listeners untuk opsi
        document.querySelectorAll('.quiz-option').forEach(option => {
            option.addEventListener('click', function() {
                document.querySelectorAll('.quiz-option').forEach(opt => opt.classList.remove('selected'));
                this.classList.add('selected');
                nextButton.disabled = false;
            });
        });
        
        // Tampilkan modal
        quizModal.classList.add('active');
    }

    // Aksi setelah kuis
    function nextQuizAction() {
        const quizResult = document.getElementById('quiz-result');
        const nextButton = document.getElementById('btn-next-quiz');
        const selectedOption = document.querySelector('.quiz-option.selected');
        
        if (selectedOption) {
            const selectedIndex = parseInt(selectedOption.getAttribute('data-index'));
            const correctIndex = parseInt(nextButton.getAttribute('data-correct-index'));
            const fact = nextButton.getAttribute('data-fact');
            
            if (selectedIndex === correctIndex) {
                quizResult.textContent = 'Benar! +50 Poin';
                quizResult.style.color = 'green';
                gameData.playerScore += 50;
                updateUI();
            } else {
                quizResult.textContent = 'Salah. Jawaban benar: ' + nextButton.getAttribute('data-fact');
                quizResult.style.color = 'red';
            }
            
            setTimeout(() => {
    quizResult.innerHTML += `<br><br><strong>Fakta Penting:</strong> ${fact}`;
}, 500);
                          // Update tombol
                nextButton.textContent = 'Tutup';
                nextButton.disabled = false;
                nextButton.removeEventListener('click', nextQuizAction);
                nextButton.addEventListener('click', () => {
                    document.getElementById('quiz-modal').classList.remove('active');
                    nextButton.textContent = 'Lanjutkan';
                    nextButton.addEventListener('click', nextQuizAction);
                    nextButton.removeEventListener('click', () => {});
                });
            }
        }

        // Menampilkan pesan
        function showMessage(message) {
            const messageElement = document.getElementById('game-message');
            messageElement.textContent = message;
            messageElement.classList.add('show');
            
            setTimeout(() => {
                messageElement.classList.remove('show');
            }, 3000);
        }

        // Inisialisasi game saat halaman dimuat
        window.addEventListener('DOMContentLoaded', () => {
            // Set nama pemain dari localStorage jika ada
            const playerName = localStorage.getItem('ecoUnoPlayerName') || 'Anda';
            gameData.players[0].name = playerName;
            
            // Set skor dari localStorage jika ada
            const savedScore = localStorage.getItem('ecoUnoPlayerScore');
            if (savedScore) {
                gameData.playerScore = parseInt(savedScore);
            }
            
            initGame();
        });

        // Simpan skor saat window ditutup
        window.addEventListener('beforeunload', () => {
            localStorage.setItem('ecoUnoPlayerScore', gameData.playerScore.toString());
        });

        // Fungsi tambahan untuk fitur yang belum diimplementasikan
        function saveGame() {
            // TODO: Implementasi penyimpanan game
            showMessage('Fitur penyimpanan game akan datang!');
        }

        function loadGame() {
            // TODO: Implementasi pemuatan game
            showMessage('Fitur pemuatan game akan datang!');
        }

        function showSettings() {
            // TODO: Implementasi pengaturan
            showMessage('Fitur pengaturan akan datang!');
        }
    </script>
</body>
</html>
